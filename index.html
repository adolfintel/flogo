<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <meta name="description" content="Create and run programs using flow charts">
    <meta name="keywords" content="flowchart, teaching tools, programming language for beginners, pwa">
    <meta name="author" content="Federico Dossena">
    <meta name="image" content="https://fdossena.com/flogo/cover.jpg">
    <title>Flogo</title>
    <link rel="icon" type="image/png" href="images/favicon.png">
    <link rel="manifest" href="manifest.json">
    <script type="text/javascript" src="platformSpecific.js"></script>
    <script type="text/javascript">
        let crashHandlerMode = 0 //0=reload on error, 1=show crash screen
        window.onerror = function(e, url, line) {
            console.log("Unhandled exception caught: " + e + " in " + url + "@" + line + ", handling error")
            const rok = document.getElementById("error_recoveryOk"),
                rf = document.getElementById("error_recoveryFailed"),
                rnn = document.getElementById("error_recoveryNotNecessary")
            if (crashHandlerMode === 1) {
                window.onerror = null
                try {
                    document.getElementById("theme").remove()
                } catch (ex) {}
                setTimeout(() => {
                    try {
                        document.querySelectorAll("body>*").forEach(e => e.style.display = "none")
                    } catch (ex) {}
                    try {
                        document.getElementById("errorScreen").style.display = "block"
                        try {
                            const res = saveProgramForRecovery()
                            if (res === 1) {
                                rok.style.display = "block"
                                rf.style.display = "none"
                                rnn.style.display = "none"
                            } else {
                                rok.style.display = "none"
                                rf.style.display = "none"
                                rnn.style.display = "block"
                            }
                        } catch (ex) {
                            rok.style.display = "none"
                            rf.style.display = "block"
                            rnn.style.display = "none"
                            delete storage.recovery
                        }
                    } catch (ex) {
                        try {
                            delete storage.recovery
                        } catch (ex) {}
                        window.location.reload()
                    }
                }, 0)
            } else if (crashHandlerMode === 0) {
                window.location.reload()
            }
        }
    </script>
    <script type="text/javascript" src="lib/jsep.iife.min.js"></script>
    <script type="text/javascript" src="lib/konva.min.js"></script>
    <script type="text/javascript" src="flogo.js"></script>
    <script type="text/javascript" src="lib/svgcanvas.min.js"></script>
    <script type="text/javascript" src="flogo-flowchart.js"></script>
    <script type="text/javascript" src="app.js"></script>
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="lib/material-design-icons/sharp.css">
    <style type="text/css">
        #loadOverlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: black;
            z-index: 99999;
        }

        #loadingSpinner {
            position: absolute;
            left: calc(50vw - 5vmin);
            top: calc(50vh - 5vmin);
            width: 10vmin;
            height: 10vmin;
            background: conic-gradient(white, black);
            border-radius: 9999rem;
            position: relative;
            animation: loading 1s linear infinite;
        }

        #loadingSpinner::after {
            content: "";
            display: block;
            background: black;
            top: 7.5%;
            left: 7.5%;
            right: 7.5%;
            bottom: 7.5%;
            position: absolute;
            border-radius: 9999rem;
        }

        @keyframes loading {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(-360deg);
            }
        }

        @media (prefers-color-scheme: light) {

            #loadOverlay,
            #loadingSpinner::after {
                background: white;
            }

            #loadingSpinner {
                background: conic-gradient(black, white);
            }
        }

        #errorScreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: black;
            z-index: 999999;
            background: #c00000;
            color: #000000;
            text-align: center;
            display: none;
        }

        #error_title {
            font-size: 3rem;
            color: #ffffff;
            font-weight: bold;
        }

        #error_title .icon {
            font-size: 6rem;
            display: block;
        }
    </style>
</head>

<body class="notranslate">
    <div id="loadOverlay">
        <div id="loadingSpinner"></div>
        <noscript>
            This app requires JavaScript to be enabled in your browser. Don't worry, it's <a href="https://github.com/adolfintel/flogo" target="_blank">free and open source</a> software 😉
        </noscript>
    </div>
    <div id="errorScreen">
        <p id="error_title">
            <span class="icon material-icons-sharp">sentiment_very_dissatisfied</span>
            Bomboclaat!
        </p>
        <p>
            Flogo has crashed. This is not a problem with your program but a bug in Flogo.
        </p>
        <p id="error_recoveryOk">
            <b>Your program can be recovered.</b><br>
            <button onclick="window.location.reload()" class="important">Restart Flogo</button>
        </p>
        <p id="error_recoveryFailed">
            <b>Unfortunately, your program was lost in the crash.</b><br>
            <button onclick="window.location.reload()" class="danger">Restart Flogo</button>
        </p>
        <p id="error_recoveryNotNecessary">
            <b>Try restarting the app, if the problem persists, try another browser.</b><br>
            <button onclick="window.location.reload()" class="important">Restart Flogo</button>
        </p>
    </div>
    <div id="errorRec" class="popup noAutoClose">
        <p>
            Flogo has just recovered from a crash. What do you want to do?
        </p>
        <p>
            <button onclick="recoverProgram()" class="important">Recover program</button>
            <button onclick="deleteRecovery()" class="danger">Discard program</button>
        </p>
    </div>
    <div id="bar">
        <span id="expandBar" class="expandCollapse" onclick="expandBar()"><span class="icon material-icons-sharp">expand_more</span>More</span>
        <span id="collapseBar" class="expandCollapse" onclick="collapseBar()"><span class="icon material-icons-sharp">expand_less</span>Less</span>
        <div id="bar_contents">
            <span class="group">
                <button id="newProgram" title="New" onclick="newProgram()"><span class="icon material-icons-sharp">note_add</span></button>
                <button id="loadProgram" title="Load" onclick="loadProgram()"><span class="icon material-icons-sharp">folder_open</span></button>
                <button id="saveProgram" title="Save" onclick="saveProgram()"><span class="icon material-icons-sharp">save_as</span></button>
                <input type="file" id="filePicker" accept=".flogo">
            </span>
            <span class="group">
                <button id="runProgram" title="Run" onclick="runProgram()"><span class="icon material-icons-sharp">play_arrow</span></button>
                <button id="pauseProgram" title="Pause" onclick="pauseProgram()"><span class="icon material-icons-sharp">pause</span></button>
                <button id="stopProgram" title="Stop" onclick="stopProgram()"><span class="icon material-icons-sharp">stop</span></button>
            </span>
            <span class="group">
                <span class="icon material-icons-sharp">bolt</span><select id="executionMode" title="Execution speed" onchange="setProgramExecutionMode()">
                    <option value="turbo">Turbo</option>
                    <option value="normal" selected>Normal</option>
                    <option value="slow">Slow</option>
                    <option value="step">Manual</option>
                </select>
            </span>
            <span class="group">
                <button id="undo" title="Undo" onclick="undo()"><span class="icon material-icons-sharp">undo</span></button>
                <button id="redo" title="Redo" onclick="redo()"><span class="icon material-icons-sharp">redo</span></button>
            </span>
            <span id="bar_settings" class="group">
                <button id="openManual" title="Documentation" onclick="openManual()"><span class="icon material-icons-sharp">question_mark</span></button>
                <button id="openSettings" title="Settings" onclick="openSettings()"><span class="icon material-icons-sharp">settings</span></button>
            </span>
        </div>
    </div>
    <div id="fps"></div>
    <div id="flowchartArea"></div>
    <div id="variablesArea">
        <div id="variablesWrapper">
            <div class="sideHeader">Variables</div>
            <div id="variableList"></div>
        </div>
    </div>
    <div id="variablesExpander" onclick="toggleVariablesArea()" ontouchstart="toggleVariablesArea()" class="expander"><span id="variablesExpander_icon" class="icon material-icons-sharp">list</span><span class="text">Variables</span></div>
    <div id="consoleArea">
        <div id="logWrapper">
            <div class="sideHeader">
                Console
                <button onclick="console_save()" title="Save text"><span class="icon material-icons-sharp">download</span></button>
            </div>
            <div id="log"></div>
        </div>
        <div id="inputArea">
            <textarea id="input" onkeydown="input_keypressed(event)" disabled></textarea>
            <button id="input_send" disabled><span class="icon material-icons-sharp">send</span></button>
        </div>
    </div>
    <div id="consoleExpander" onclick="toggleConsoleArea()" ontouchstart="toggleConsoleArea()" class="expander"><span id="consoleExpander_icon" class="icon material-icons-sharp">chat_bubble</span><span class="text">Console</span></div>
    <div id="turtleArea" class="window">
        <div class="window_bar">
            <div class="window_title">Turtle graphics</div>
            <div class="window_buttons">
                <button id="turtle_openMenu" onclick="turtle_openMenu()"><span class="icon material-icons-sharp">menu</span></button>
                <button onclick="ui_turtle_hide()"><span class="icon material-icons-sharp">close</span></button>
            </div>
        </div>
        <div id="ui_turtle_canvas" class="window_contents"></div>
    </div>
    <div id="turtleMenu" class="popup">
        <div id="turtleMenu_savePNG" onclick="turtle_savePNG()"><span class="icon material-icons-sharp">image</span>Save as PNG</div>
        <div id="turtleMenu_hideCursor" onclick="turtle_hideCursor()"><span class="icon material-icons-sharp">visibility_off</span>Hide turtle</div>
        <div id="turtleMenu_showCursor" onclick="turtle_showCursor()"><span class="icon material-icons-sharp">visibility</span>Show turtle</div>
    </div>
    <div id="popupBackdrop" onclick="closePopup()"></div>
    <div id="insertWide" class="popup"></div>
    <div id="insertTall" class="popup"></div>
    <div id="crash" class="popup">
        <div class="autoVert">
            <div id="crash_title"><span class="icon material-icons-sharp">report_problem</span>Prorgam crashed!</div>
            <div id="crash_details"></div>
        </div>
        <div id="crash_buttons">
            <button onclick="closePopup()" class="important">Ok</button>
        </div>
    </div>
    <div id="loadError" class="popup">
        <div class="autoVert">
            <div id="loadError_title"><span class="icon material-icons-sharp">file_download_off</span>Loading failed</div>
            <div id="loadError_details"></div>
        </div>
        <div id="loadError_buttons">
            <button onclick="closePopup()" class="important">Ok</button>
        </div>
    </div>
    <div id="editor" class="popup noAutoClose">
        <div id="editor_Input">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="Input"></div>
                <div class="editor_graphics_description">An input instruction reads a value from the user and stores it in a variable</div>
            </div>
            <div class="autoVert">
                <label for="editor_Input_variable">Variable</label>
                <input type="text" flogo_attr="variable" id="editor_Input_variable" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
            </div>
        </div>
        <div id="editor_Output">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="Output"></div>
                <div class="editor_graphics_description">An output instruction evaluates an expression and shows the result to the user</div>
            </div>
            <div class="autoVert">
                <label for="editor_Output_expression">Expression</label>
                <textarea id="editor_Output_expression" flogo_attr="expression" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                <div>
                    <input type="checkbox" id="editor_Output_newLine" flogo_attr="newLine">
                    <label for="editor_Output_newLine">New line</label>
                </div>
            </div>
        </div>
        <div id="editor_Assign">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="Assign"></div>
                <div class="editor_graphics_description">An assignment instruction evaluates an expression and stores the result in a variable</div>
            </div>
            <div class="autoVert">
                <label for="editor_Assign_variable">Variable</label>
                <input type="text" flogo_attr="variable" id="editor_Assign_variable" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
                <label for="editor_Assign_expression" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">Expression</label>
                <textarea id="editor_Assign_expression" flogo_attr="expression" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
            </div>
        </div>
        <div id="editor_If">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="If"></div>
                <div class="editor_graphics_description">An if instruction evaluates an expression and executes the true or false branch depending on the result</div>
            </div>
            <div class="autoVert">
                <label for="editor_If_condition">Condition</label>
                <textarea id="editor_If_condition" flogo_attr="condition" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
            </div>
        </div>
        <div id="editor_DoWhile">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="DoWhile"></div>
                <div class="editor_graphics_description">A Do-While loop repeats the instructions inside it until the expression becomes false, the expression is evaluated at the end of each loop</div>
            </div>
            <div class="autoVert">
                <label for="editor_DoWhile_condition">Condition</label>
                <textarea id="editor_DoWhile_condition" flogo_attr="condition" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
            </div>
        </div>
        <div id="editor_While">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="While"></div>
                <div class="editor_graphics_description">A While loop repeats the instructions inside it until the expression becomes false, the expression is evaluated before each loop</div>
            </div>
            <div class="autoVert">
                <label for="editor_While_condition">Condition</label>
                <textarea id="editor_While_condition" flogo_attr="condition" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
            </div>
        </div>
        <div id="editor_For">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="For"></div>
                <div class="editor_graphics_description">A for loop automatically increments or decrements a variable, usually a counter, through a range of values</div>
            </div>
            <div class="autoVert">
                <label for="editor_For_variable">Variable</label>
                <input type="text" flogo_attr="variable" id="editor_For_variable" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
                <div class="autoHor">
                    <div class="autoVert">
                        <label for="editor_For_from">From</label>
                        <textarea id="editor_For_from" flogo_attr="from" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                    </div>
                    <div class="autoVert">
                        <label for="editor_For_to">To</label>
                        <textarea id="editor_For_to" flogo_attr="to" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                    </div>
                </div>
                <div class="autoHor">
                    <div class="autoVert">
                        <label for="editor_For_direction">Direction</label>
                        <select id="editor_For_direction" flogo_attr="direction">
                            <option value="up">Increasing</option>
                            <option value="down">Decreasing</option>
                        </select>
                    </div>
                    <div class="autoVert">
                        <label for="editor_For_step">Step</label>
                        <textarea id="editor_For_step" flogo_attr="step" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div id="editor_Comment">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="Comment"></div>
                <div class="editor_graphics_description">Comments have no effect on your program, they are useful to store notes or to document how you solved a problem</div>
            </div>
            <div class="autoVert">
                <label for="editor_Comment_text">Text</label>
                <textarea id="editor_Comment_text" flogo_attr="text"></textarea>
            </div>
        </div>
        <div id="editor_Breakpoint">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="Breakpoint"></div>
                <div class="editor_graphics_description">The program will automatically pause here</div>
            </div>
        </div>
        <div id="editor_Move">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="Move"></div>
                <div class="editor_graphics_description">A Move/Draw instruction moves the turtle by the specified distance. You can choose whether to draw a line to the new location or not</div>
            </div>
            <div class="autoVert">
                <label for="editor_Move_expression">Expression</label>
                <textarea id="editor_Move_expression" flogo_attr="expression" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                <div>
                    <input type="checkbox" id="editor_Move_draw" flogo_attr="draw">
                    <label for="editor_Move_newLine">Draw</label>
                </div>
            </div>
        </div>
        <div id="editor_Turn">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="Turn"></div>
                <div class="editor_graphics_description">A Turn instruction changes the angle of the turtle by the specified amount of degrees, turning it either right (clockwise) or left (counter-clockwise)</div>
            </div>
            <div class="autoVert">
                <label for="editor_Turn_expression">Expression (degrees)</label>
                <textarea id="editor_Turn_expression" flogo_attr="expression" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></textarea>
                <div>
                    <label for="editor_Turn_direction">Direction</label>
                    <select id="editor_Turn_direction" flogo_attr="direction">
                        <option value="cw">Right</option>
                        <option value="ccw">Left</option>
                    </select>
                </div>
            </div>
        </div>
        <div id="editor_Home">
            <div class="editor_graphics_container">
                <div class="editor_graphics" flogo_instruction="Home"></div>
                <div class="editor_graphics_description">The turtle will return to the center of the drawing area, pointing upwards</div>
            </div>
        </div>
        <div id="editor_buttons">
            <button onclick="edit_confirm()" class="important">Ok</button>
            <button onclick="closePopup(true)">Cancel</button>
            <!--<button onclick="edit_delete()" class="danger floatRight">Delete</button>-->
        </div>
    </div>
    <div id="editor2" class="popup">
        <div id="editor2_edit"><span class="icon material-icons-sharp">create</span>Edit</div>
        <div id="editor2_addToSelection"><span class="icon material-icons-sharp">add</span>Select</div>
        <div id="editor2_removeFromSelection"><span class="icon material-icons-sharp">remove</span>Deselect</div>
        <div id="editor2_cut"><span class="icon material-icons-sharp">content_cut</span>Cut</div>
        <div id="editor2_copy"><span class="icon material-icons-sharp">content_copy</span>Copy</div>
        <div id="editor2_delete"><span class="icon material-icons-sharp">delete</span>Delete</div>
    </div>
    <div id="yesno" class="popup">
        <div class="autoVert">
            <div id="yesno_title"><span class="icon material-icons-sharp">delete_forever</span><span id="yesno_title_text"></span></div>
            <div id="yesno_details"></div>
        </div>
        <div id="yesno_buttons">
            <button id="yesno_yes" class="danger">Yes</button>
            <button id="yesno_no" class="important">No</button>
        </div>
    </div>
    <div id="settings" class="popup noAutoClose">
        <div id="settings_tabSelector">
            <div for="program_metadata" onclick="settings_selectTab('program_metadata')">Program</div>
            <div for="settings_style" onclick="settings_selectTab('settings_style')">Style</div>
            <div for="settings_export" onclick="settings_selectTab('settings_export')">Export</div>
            <div for="settings_advanced" onclick="settings_selectTab('settings_advanced')">Advanced</div>
            <div for="settings_about" onclick="settings_selectTab('settings_about')">About</div>
        </div>
        <div id="settings_tabs">
            <div id="program_metadata" class="settings_tab">
                <p class="settings_desc">
                    Information about your program. This will be saved into the program when you save it.
                </p>
                <div class="autoVert">
                    <label for="metadata_title">Title</label>
                    <input type="text" id="metadata_title">
                    <label for="metadata_author">Author</label>
                    <input type="text" id="metadata_author">
                </div>
                <div class="settings_tab_buttons">
                    <button class="important" onclick="settings_updateMetadata()">Save</button>
                    <button onclick="closePopup(true)">Close</button>
                </div>
            </div>
            <div id="settings_style" class="settings_tab">
                <p class="settings_desc">
                    Choose a theme for the application. This setting will be saved for the current user, but not in your program.
                </p>
                <div>
                    <label for="style_theme">Theme</label>
                    <select id="style_theme" onchange="settings_setTheme()">
                        <optgroup label="Dark">
                            <option value="default_dark">🌘 Default</option>
                            <option value="night_dark">🌘 Night city</option>
                            <option value="alchemy_dark">🌘 Alchemy</option>
                            <option value="glass_dark">🌘 Glass</option>
                        </optgroup>
                        <optgroup label="Light">
                            <option value="default_light">☀️ Default</option>
                            <option value="colorful_light">☀️ Colorful</option>
                            <option value="sakura_light">☀️ Sakura</option>
                        </optgroup>
                        <optgroup label="Special">
                            <option value="eink_light">E-Ink</option>
                        </optgroup>
                    </select>
                </div>
                <div class="settings_tab_buttons">
                    <button onclick="closePopup(true)">Close</button>
                </div>
            </div>
            <div id="settings_export" class="settings_tab">
                <p class="settings_desc">
                    Save the flow chart as an image, so you can put it in your documents or web pages. Note that exported programs are just images and you won't be able to open them in Flogo.
                </p>
                <div>
                    <div>
                        <label for="export_format">Export as</label>
                        <select id="export_format">
                            <option id="export_format_svg" value="svg">SVG</option>
                            <option value="png" selected>PNG</option>
                        </select>
                    </div>
                    <div>
                        <input type="checkbox" id="export_background" checked><label for="export_background">Keep background color</label>
                    </div>
                </div>
                <div class="settings_tab_buttons">
                    <button class="important" onclick="settings_export()">Export</button>
                    <button onclick="closePopup(true)">Close</button>
                </div>
            </div>
            <div id="settings_advanced" class="settings_tab">
                <p class="settings_desc">
                    Don't touch these unless you know what you're doing.
                </p>
                <div class="autoVert">
                    <div>
                        <input type="checkbox" id="settings_fps" onchange="settings_fps_changed()"><label for="settings_fps">FPS counter</label><br>
                        <input type="checkbox" id="settings_allowZoomOnFlowchart" onchange="settings_allowZoomOnFlowchart_changed()"><label for="settings_allowZoomOnFlowchart">Allow zooming of flow chart using Ctrl+Wheel</label><br>
                        <input type="checkbox" id="settings_altTurboTSlice" onchange="settings_altTurboTSlice_changed()"><label for="settings_altTurboTSlice">Longer timeslice in turbo mode (for low-end PCs)</label><br>
                        <input type="checkbox" id="settings_unlimitedTurtle" onchange="settings_unlimitedTurtle_changed()"><label for="settings_unlimitedTurtle">Don't delete old lines in Turtle Graphics (can cause lag)</label>
                    </div>
                </div>
                <div class="settings_tab_buttons">
                    <button onclick="closePopup(true)">Close</button>
                </div>
            </div>
            <div id="settings_about" class="settings_tab">
                <div class="autoVert">
                    <div><img src="images/logo_large.webp" id="about_logo" alt="Logo"></div>
                    <div>Flogo - Version 1.2.1 (dev)<span id="versionTypeBadge"></span></div>
                    <div>Made with ❤️ by <a href="https://fdossena.com" target="_blank">Federico Dossena</a></div>
                    <div>Distributed under the <a href="javascript:showLicense()">GNU AGPL v3</a> license</div>
                    <div><a href="https://fdossena.com/?p=flogo/index.frag" target="_blank">Website</a> | <a href="https://github.com/adolfintel/flogo" target="_blank">GitHub</a></div>
                </div>
                <div class="settings_tab_buttons">
                    <button onclick="closePopup(true)">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div id="toasts"></div>
    <div id="man" class="popup noAutoClose">
        <div id="man_contents">
            <img src="images/logo_large.webp" id="man_logo">
            <h1>Documentation</h1>
            <ul>
                <li><a onclick="man_scrollTo('variables')">Variables and types</a></li>
                <li><a onclick="man_scrollTo('instructions')">Basic instructions</a></li>
                <li>
                    <a onclick="man_scrollTo('expressions')">Expressions</a>
                    <ul>
                        <li><a onclick="man_scrollTo('operators1')">Mathematical operators</a></li>
                        <li><a onclick="man_scrollTo('operators2')">Comparison operators</a></li>
                        <li><a onclick="man_scrollTo('operators3')">Logic operators</a></li>
                        <li><a onclick="man_scrollTo('functions')">Built-in functions</a></li>
                        <li><a onclick="man_scrollTo('constants')">Built-in constants</a></li>
                    </ul>
                </li>
                <li><a onclick="man_scrollTo('turtle')">Graphics</a></li>
            </ul>
            <a name="variables"></a>
            <h2>Variables and types</h2>
            <h3>Variables</h3>
            <p>
                Variables can be used to store data that your program needs to work.<br>
                Each variable has:
            </p>
            <ul>
                <li><b>Name</b>: a short name that lets you use the variable in expressions. Names can only contain letters and numbers and the underscore symbol "_" and must start with a letter. Spaces, symbols and accented letters are not allowed. Also, variables can't have the same name as one of the <a onclick="man_scrollTo('constants')">built-in constants</a>. Names are case-sensitive, meaning that the variable <code>n</code> is not the same as the variable <code>N</code>.</li>
                <li><b>Type</b>: what kind of value can be stored in the variable: Integer, Real, String or Boolean</li>
                <li><b>Initial value</b>: if you want, you can give a value to the variable automatically when the program starts. This is useful for things like counters that have to start at 0, or for constants such as a speed limit</li>
            </ul>
            <h3>Types</h3>
            <h4>Integer</h4>
            <p>
                Can be used to store integer numbers, positive or negative.<br>
                If a real number is stored into an integer, the decimal digits are lost.
            </p>
            <p>
                Valid values for an integer are <code>-9007199254740991</code> to <code>9007199254740991</code>.
            </p>
            <h4>Real</h4>
            <p>
                Can be used to store real numbers, positive or negative.
            </p>
            <p>
                Real numbers don't have a valid range, but they lose accuracy as they become larger.<br>
                It is generally a bad idea to store an integer number in a real variable.
            </p>
            <h4>String</h4>
            <p>
                Can be used to store text. There is no maximum length, but huge strings may slow down the program or crash the browser.
            </p>
            <h4>Boolean</h4>
            <p>
                Can store a value that's either <code>true</code> or <code>false</code>.
            </p>
            <a name="instructions"></a>
            <h2>Basic instructions</h2>
            <h4>Input</h4>
            <p>
                Reads a value from the user and stores it in a variable.
            </p>
            <h4>Output</h4>
            <p>
                Evaluates an expression and shows the result to the user.
            </p>
            <ul>
                <li><b>Expression</b>: what you want to output. You can output text directly by putting it in "double quotes", you can output variables by typing their name, or you can do a mix of text and variables using the <code>+</code> symbol. Example: <code>"The total is "+total+"€"</code></li>
                <li><b>New line</b>: by default, each output instruction creates a new bubble in the chat. If you turn this off, the next output will be added to the bubble created by this one</li>
            </ul>
            <h4>Assign</h4>
            <p>
                Evaluates an expression and stores the result in a variable.
            </p>
            <ul>
                <li><b>Variable</b>: the variable where you want to put the result of the expression</li>
                <li><b>Expression</b>: the expression to evaluate. You can use numbers, variables, mathematical operators, functions, etc.</li>
            </ul>
            <p>
                Be careful! Some automatic type conversions can happen if variables are not of the same type. For instance, if the expression gives a real value but your variable is an integer, it will lose the decimal digits; if the expression gives an integer number and your variable is a string, it will be converted to text. Your program only crashes if the types are completely incompatible, for instance if your expression gives a string but you're trying to store it in a real variable.
            </p>
            <h4>If</h4>
            <p>
                Evaluates an expression and executes the True or False branch depending on the result.<br>
                The expression can contain numbers, variables, mathematical operators, etc. but it can also contain comparison and logical operators. For instance, the expression <code>a&gt;=0&amp;&amp;a&lt;=10</code> tells you if the variable <code>a</code> is between <code>0</code> and <code>10</code>.
            </p>
            <p>
                It's important to remember that the expression must give a true/false value, any other type will crash your program.
            </p>
            <h4>Do-While</h4>
            <p>
                Repeats the instructions inside it until the condition at the end becomes false.<br>
                The condition is checked at the end of each loop, so the contents of the loop will always be executed at least once; this makes it useful for things like input validation.
            </p>
            <p>
                Like in the If instruction, the condition must give a true/false value.
            </p>
            <h4>While</h4>
            <p>
                Repeats the instructions inside it until the condition at the top becomes false.<br>
                The condition is checked at the beginning of each loop, so it's possible for the loop to not be executed at all if the condition is immediately false.
            </p>
            <p>
                Like in the If instruction, the condition must give a true/false value.
            </p>
            <h4>For</h4>
            <p>
                A for loop repeats the instructions inside it like a While loop, but it also handles a variable (usually a counter) automatically, incrementing or decrementing it at the end of each loop.
            </p>
            <ul>
                <li>
                    <b>Variable</b>: name of the variable to be handled automatically by the loop
                </li>
                <li>
                    <b>From</b>: the initial value for the variable. It can be a number or an expression
                </li>
                <li>
                    <b>To</b>: the final value for the variable. This tells the for loop when to stop. It can be a number or an expression
                </li>
                <li>
                    <b>Direction</b>: the direction of the loop, either increasing or decreasing. If the loop is increasing, then <b>To</b> must be greater than <b>From</b>; if it's decreasing, <b>To</b> must be lower than <b>From</b>
                </li>
                <li>
                    <b>Step</b>: how much to increase/decrease the variable at the end of each loop. It can be a number or an expression
                </li>
            </ul>
            <p>
                Note: the from-to range is inclusive!
            </p>
            <h4>Comment</h4>
            <p>
                Comments have no effect on the program, they are useful to store notes or to document how things work.
            </p>
            <h4>Breakpoint</h4>
            <p>
                Automatically pauses execution of the program. Useful for debugging.
            </p>
            <a name="expressions"></a>
            <h2>Expressions</h2>
            <p>
                Expressions can be used to write mathematical expressions, conditions and conditions.
            </p>
            <p>
                Expressions can contain a mix of variables, values, operators and functions.<br>
                Variable names and numeric values can be written directly (for instance, <code>a+1</code>), strings must use quotes or double quotes (for instance, <code>'The price is: '+price</code>), functions use parenthesis and commas to delimit their parameters (for instance, <code>toFixed(price,2)</code>).
            </p>
            <p>
                Expressions are evaluated in this order:
            <ul>
                <li>Functions</li>
                <li>Mathematical operators</li>
                <li>Comparison operators</li>
                <li>Logical operators</li>
            </ul>
            </p>
            <p>
                The following tables list all the operators included in Flogo in order of precedence. Round parenthesis can be used to alter the order of evaluation of the expression (for instance, <code>n/(a+1)</code>); parenthesis can also be nested.
            </p>
            <a name="operators1"></a>
            <h3>Mathematical operators</h3>
            <table>
                <thead>
                    <tr>
                        <th>Operator</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>a ^ b</td>
                        <td>Power</td>
                    </tr>
                    <tr>
                        <td>a * b</td>
                        <td>Multiplication</td>
                    </tr>
                    <tr>
                        <td>a / b</td>
                        <td>Division (real)</td>
                    </tr>
                    <tr>
                        <td>a % b</td>
                        <td>Modulus (remainder of integer division)</td>
                    </tr>
                    <tr>
                        <td>a + b</td>
                        <td>Addition (if both operands are numbers)</td>
                    </tr>
                    <tr>
                        <td>a + b</td>
                        <td>String concatenation (if at least one of the operands is a string)</td>
                    </tr>
                    <tr>
                        <td>a - b</td>
                        <td>Subtraction</td>
                    </tr>
                </tbody>
            </table>
            <a name="operators2"></a>
            <h3>Comparison operators</h3>
            <p>
                Comparison operators can be used in conditions to compare a value to another. For instance, <code>a==0</code> is true if the variable <code>a</code> has a value of <code>0</code>.
            </p>
            <table>
                <thead>
                    <tr>
                        <th>Operator</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>a &lt; b</td>
                        <td>Lower than</td>
                    </tr>
                    <tr>
                        <td>a &gt; b</td>
                        <td>Greater than</td>
                    </tr>
                    <tr>
                        <td>a &lt;= b</td>
                        <td>Lower or equal</td>
                    </tr>
                    <tr>
                        <td>a &gt;= b</td>
                        <td>Greater or equal</td>
                    </tr>
                    <tr>
                        <td>a == b</td>
                        <td>Equals</td>
                    </tr>
                    <tr>
                        <td>a != b</td>
                        <td>Different</td>
                    </tr>
                </tbody>
            </table>
            <a name="operators3"></a>
            <h3>Logical operators</h3>
            <p>
                Logical operators allow you to "chain together" multiple conditions. For instance, <code>a&lt;0||a&gt;10</code> is true if the variable <code>a</code> is not between <code>0</code> and <code>10</code>.
            </p>
            <table>
                <thead>
                    <tr>
                        <th>Operator</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>! expr</td>
                        <td>Not<br>Inverts the value of the expression</td>
                    </tr>
                    <tr>
                        <td>a &amp;&amp; b</td>
                        <td>And<br>All expressions must be true for the entire condition to be true</td>
                    </tr>
                    <tr>
                        <td>a || b</td>
                        <td>Or<br>At least one expression must be true for the entire condition to be true</td>
                    </tr>
                </tbody>
            </table>
            <a name="functions"></a>
            <h3>Built-in functions</h3>
            <p>
                Flogo has a lot of buit-in functions that make writing expressions easier. For instance, <code>round(a)</code> will give you the value of the variable <code>a</code> rounded mathematically.
            </p>
            <h4>Mathematics</h4>
            <table>
                <thead>
                    <tr>
                        <th>Function</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>abs(n)</td>
                        <td>Absolute value</td>
                    </tr>
                    <tr>
                        <td>sqrt(n)</td>
                        <td>Square root</td>
                    </tr>
                    <tr>
                        <td>sin(n)</td>
                        <td>Sine (n is an angle in radians)</td>
                    </tr>
                    <tr>
                        <td>cos(n)</td>
                        <td>Cosine (n is an angle in radians)</td>
                    </tr>
                    <tr>
                        <td>tan(n)</td>
                        <td>Tangent (n is an angle in radians)</td>
                    </tr>
                    <tr>
                        <td>asin(n)</td>
                        <td>Arcsine</td>
                    </tr>
                    <tr>
                        <td>acos(n)</td>
                        <td>Arcosine</td>
                    </tr>
                    <tr>
                        <td>atan(n)</td>
                        <td>Arctangent</td>
                    </tr>
                    <tr>
                        <td>ln(n)</td>
                        <td>Natural logarithm (base E)</td>
                    </tr>
                    <tr>
                        <td>log(base,val)</td>
                        <td>Logarithm</td>
                    </tr>
                    <tr>
                        <td>ceil(n)</td>
                        <td>Round up to nearest integer</td>
                    </tr>
                    <tr>
                        <td>floor(n)</td>
                        <td>Round down to nearest integer</td>
                    </tr>
                    <tr>
                        <td>round(n)</td>
                        <td>Mathematical rounding</td>
                    </tr>
                    <tr>
                        <td>random()</td>
                        <td>Random real number between 0 and 1</td>
                    </tr>
                </tbody>
            </table>
            <h4>Strings</h4>
            <table>
                <thead>
                    <tr>
                        <th>Function</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>toFixed(n,d)</td>
                        <td>Converts a number into a string with d decimal digits</td>
                    </tr>
                    <tr>
                        <td>len(s)</td>
                        <td>Length of a string</td>
                    </tr>
                    <tr>
                        <td>charAt(s,i)</td>
                        <td>Returns the character in position i in the string s.<br>The first character in a string has position 0</td>
                    </tr>
                    <tr>
                        <td>charToCode(c)</td>
                        <td>Converts a character into the corresponding ASCII code (integer)</td>
                    </tr>
                    <tr>
                        <td>codeToChar(n)</td>
                        <td>Converts an ASCII code into the corresponding character</td>
                    </tr>
                    <tr>
                        <td>strToReal(s)</td>
                        <td>Converts a string into a real number</td>
                    </tr>
                    <tr>
                        <td>strToInt(s)</td>
                        <td>Converts a string into an integer number</td>
                    </tr>
                </tbody>
            </table>
            <a name="constants"></a>
            <h3>Built-in constants</h3>
            <table>
                <thead>
                    <tr>
                        <th>Constant</th>
                        <th>Value</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>PI</td>
                        <td>3.141592653589793</td>
                    </tr>
                    <tr>
                        <td>E</td>
                        <td>2.718281828459045</td>
                    </tr>
                    <tr>
                        <td>CURRENT_DAY</td>
                        <td>Current day of month</td>
                    </tr>
                    <tr>
                        <td>CURRENT_MONTH</td>
                        <td>Current month (1=January, 12=December)</td>
                    </tr>
                    <tr>
                        <td>CURRENT_YEAR</td>
                        <td>Current year</td>
                    </tr>
                    <tr>
                        <td>CURRENT_HOURS</td>
                        <td>Current hours (24h format)</td>
                    </tr>
                    <tr>
                        <td>CURRENT_MINUTES</td>
                        <td>Current minutes</td>
                    </tr>
                    <tr>
                        <td>CURRENT_SECONDS</td>
                        <td>Current seconds</td>
                    </tr>
                </tbody>
            </table>
            <a name="turtle"></a>
            <h2>Graphics</h2>
            <p>
                The basic concept behind Turtle Graphics is that you're controlling a cursor (called "turtle"). When the program is started, the turtle is at the center of the drawing area (its "home") and it's pointing up, then you can use instructions to move it, can draw a line while moving, turn it left or right and it can also instantly move back to its home.
            </p>
            <h4>Move/Draw</h4>
            <p>
                A Move/Draw instruction moves the turtle by the specified distance in the direction that it's currently pointing at. It can draw a line behind it while moving.
            </p>
            <ul>
                <li><b>Expression</b>: how much you want to move. It can be a simple number or a mathematical expression using your variables</li>
                <li><b>Draw</b>: if enabled, it draws a line while moving, otherwise the turtle will just move without drawing anything</li>
            </ul>
            <h4>Turn</h4>
            <p>
                A Move/Draw instruction changes the angle that the turtle is currently pointing at by a specified amount of degrees.
            </p>
            <ul>
                <li><b>Expression</b>: how many degrees much you want the turtle to turn by. It can be a simple number or a mathematical expression using your variables</li>
                <li><b>Direction</b>: whether to turn the turtle left or right</li>
            </ul>
            <h4>Home</h4>
            <p>
                Instantly moves the turtle back to the starting position (its "home"), pointing upwards. It does not draw a line while moving.
            </p>
        </div>
        <button id="man_close" onclick="closePopup(true)"><span class="icon material-icons-sharp">close</span></button>
    </div>
    <div id="licenseViewer" class="popup noAutoClose">
        <iframe src="LICENSE.txt" id="license"></iframe>
        <button id="license_close" onclick="hideLicense()"><span class="icon material-icons-sharp">close</span></button>
    </div>
    <script type="text/javascript">
        initApp()
    </script>
</body>

</html>
